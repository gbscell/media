<?php
// Powered X-Rere Script
// Supported I-WRAH Tools
// Punya MasbimCH

echo '#EXTINF:-1 tvg-logo="https://aipitv.my.id/tvlogo/sctv.png" group-title="Nasional",SCTV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'204')."\n";

echo '#EXTINF:-1 tvg-logo="https://aipitv.my.id/tvlogo/indosiar.png" group-title="Nasional",INDOSIAR'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'205')."\n";

echo '#EXTINF:-1 tvg-logo="https://aipitv.my.id/tvlogo/mentaritv.png" group-title="Anak-Anak",Mentari TV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'8237')."\n";

echo '#EXTINF:-1 tvg-logo="https://aipitv.my.id/tvlogo/mojitv.png" group-title="Olahraga", Moji'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'206')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/v6g4kUrA-1XKkAbAKtWBpeQKCrc=/640x360/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/874/kompas-tv-a3cbc6.jpg" group-title="LOKAL", Kompas TV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'874')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/xFDGoUw47NRbd41mStQo6U0YVdg=/640x360/filters:strip_icc():quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/783/tvone-e53f94.jpg" group-title="LOKAL", TV One'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'783')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/wOv52L0rWu1k_zY8wY6re_OUMXI=/640x360/filters:strip_icc():quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/6165/beritasatu-e7ed52.jpg" group-title="LOKAL", Berita Satu'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'6165')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/yeb8bJ4CWiB44AXZPJx8Sf_QUvE=/640x360/filters:strip_icc():quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/777/metro-tv-461c64.jpg" group-title="LOKAL", Metro TV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'777')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/nkx4zlhDNBRVq7e8EWpxeydRWJE=/640x360/filters:strip_icc():quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/782/antv-tv-stream-b6cca5.jpg" group-title="LOKAL", ANTV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'782')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/uhO4k9iqRVaHjZeJXJ2KpRw_w-k=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/733/trans-tv-stream-7ab79a.jpg" group-title="LOKAL", Trans TV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'733')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/fgcHi2h8yWt6Bc3A7XSquRqWDCQ=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/665/rcti-e4a143.jpg" group-title="LOKAL", RCTI'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'665')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/y2EK0E-_czvxzROVu4AMCuywmCw=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/734/trans7-tv-stream-b793ab.jpg" group-title="LOKAL", Trans7'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'734')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/eI49eXBY54xsgtlYOP5B0QxWsos=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/870/mnc-tv-stream-f8ee1c.jpg" group-title="LOKAL", MNCTV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'870')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/wvdRhdMK03uRg3TYxy2vUvQZpOs=/640x360/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/5415/jaktv-tv-stream-a705ed.jpg" group-title="LOKAL", JAK TV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'5415')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/Xye0dwc1q7gsdu4aUfOywAouEYc=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/778/global-tv-stream-1aea79.jpg" group-title="LOKAL", GTV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'778')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/GdCgs7TSfDxuvoqhqCWKFrafCPs=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/875/net-tv-b8499f.jpg" group-title="LOKAL", NET TV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/','875')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/1TMD8nonXrRVhDaBUo7VQgJGkQc=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/1561/rtv-stream-06c6dc.jpg" group-title="LOKAL", RTV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'1561')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/iwgmFnVw3R8ZlasU7LXJFnGpZBY=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/5409/inews-tv-stream-966ec1.jpg" group-title="LOKAL", I-News'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'5409')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/xNJXtpcPbYfBrITNITOGK1F0IyQ=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/6166/oshop-tv-stream-c16bc3.jpg" group-title="LOKAL", O SHop'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'6166')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/ITgomqe4r80G_YlUJO-ZLBdgztM=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/6441/tvri-tv-stream-f6cbb3.jpg" group-title="LOKAL", TVRI'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'6441')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/iedROl3N-D7coBcwxvKAi-oyuTM=/filters:strip_icc():quality(70)/vidio-web-prod-user/uploads/user/avatar/31156578/sosmed_3-f26d9d.jpg" group-title="LOKAL", MYTV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'734')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/yLGAvvWnDmtFamZToqMh4ZprUxA=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/6482/daai-tv-stream-6dc185.jpg" group-title="LOKAL", DAAI TV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'6482')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/e8Agnu8DgWFJBwVWW5QTFNI8NNs=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/8241/rans-channel-2a6db6.jpg" group-title="LOKAL", RANS'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'8241')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/Iqs6mheIjesM4cUEh_dUVIdV0jU=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/8237/mentari-tv-b64c27.jpg" group-title="LOKAL", Mentari TV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'8237')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/2xoo5Bid2cVw63f3j-4qQw9wLpM=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/6533/zoomoo-7fdb7d.jpg" group-title="LOKAL", ZooMo'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'6684')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/XSuVX_Gt2ih1MzYNatKiEy3MCjs=/filters:quality(70)/vidio-web-prod-livestreaming/uploads/livestreaming/image/7464/ajwa-tv-9e9e9e.jpg" group-title="LOKAL", Ajwa'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'7464')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/5QTd_noifWZzn0tvSez8mZr5z0M=/smart/filters:strip_icc():quality(70)/vidio-web-prod-user/uploads/user/avatar/105799180/LogoJPMTV-fff81228bcb89e8d.png" group-title="LOKAL", JPM TV'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'9714')."\n";

echo '#EXTINF:-1 tvg-logo="https://thumbor.prod.vidiocdn.com/5QTd_noifWZzn0tvSez8mZr5z0M=/smart/filters:strip_icc():quality(70)/vidio-web-prod-user/uploads/user/avatar/105799180/LogoJPMTV-fff81228bcb89e8d.png" group-title="LOKAL",Horee'."\n";
echo gbscell('https://app-etslive-2.vidio.com/live/' ,'6397')."\n";


function gbscell($url, $aw){
  $ch = curl_init();

  curl_setopt($ch, CURLOPT_URL, 'https://www.vidio.com/live/'.$aw.'/tokens');
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  curl_setopt($ch, CURLOPT_POST, 1);
  curl_setopt($ch, CURLOPT_ENCODING, 'gzip, deflate');

  $headers = array();
  $headers[] = 'Authority: https://www.vidio.com/';
  $headers[] = 'Content-Length: 0';
  $headers[] = 'Origin: https://www.vidio.com';
  $headers[] = 'User-Agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36';
  $headers[] = 'Dnt: 1';
  $headers[] = 'Accept: */*';
  $headers[] = 'Sec-Fetch-Site: same-origin';
  $headers[] = 'Sec-Fetch-Mode: cors';
  $headers[] = 'Referer: https://www.vidio.com/';
  $headers[] = 'Accept-Encoding: gzip, deflate, br';
  $headers[] = 'Accept-Language: id-ID,id;q=0.9,en-US;q=0.8,en;q=0.7';
  curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

  $result = curl_exec($ch);
  if (curl_errno($ch)) {
    echo 'Error:' . curl_error($ch);
  }

  $result = json_decode($result, true);
  $token = $result['token'];
  curl_close($ch);
  
  if (preg_match("/@/", $url)) {
    $urlreq = $url.'/master.m3u8?'.$token;
  }else{
    $urlreq = $url.$aw.'/master.m3u8?'.$token;
  }
  // echo $urlreq;
  $ch = curl_init();

  curl_setopt($ch, CURLOPT_URL, $urlreq);
  curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);
  curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'GET');

  curl_setopt($ch, CURLOPT_ENCODING, 'gzip, deflate');

  $headers = array();
  $headers[] = 'Authority: app-etslive-2.vidio.com';
  $headers[] = 'Origin: https://www.vidio.com';
  $headers[] = 'User-Agent: Mozilla/5.0 (Windows NT 6.2; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/108.0.0.0 Safari/537.36';
  $headers[] = 'Dnt: 1';
  $headers[] = 'Accept: */*';
  $headers[] = 'Sec-Fetch-Site: same-site';
  $headers[] = 'Sec-Fetch-Mode: cors';
  $headers[] = 'Referer: https://www.vidio.com/';
  $headers[] = 'Accept-Encoding: gzip, deflate, br';
  $headers[] = 'Accept-Language: id-ID,id;q=0.9,en-US;q=0.8,en;q=0.7';
  curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);

  $result = curl_exec($ch);
  if (curl_errno($ch)) {
      echo 'Error:' . curl_error($ch);
  }
  $result = preg_replace('/#(.*?)\n/', '', $result);
  // $result = explode("\n", );
  $result = preg_replace('/#EXT-X-STREAM-INF:PROGRAM-ID=1,CLOSED-CAPTIONS=NONE,BANDWIDTH=(.*?)RESOLUTION(.*?)\n/', '', $result);
  $tot = count(explode("\n", $result));
  if ($tot <= 1) {
    echo 'https://cdn-production-thumbor-vidio.akamaized.net/iCK1LEwF_Id8Zemlc84HDAzkywU=/830x460/filters:quality(80)/vidio-web-prod-livestreaming/uploads/livestreaming/blocking_banner_image/783/49b007.jpg'."\n";
  }else{
    $dat = explode("\n", $result);
    // echo $dat[0];
    preg_match_all('/(.*?)_720(.*?)\n/', $result, $match);
    // preg_match_all('/(.*?)_480(.*?)\n/', $result, $match);
    if (count($match[0])<=1) {
      preg_match_all('/(.*?)_480(.*?)\n/', $result, $match);
        if (count($match[0])<=1) {
        preg_match_all('/(.*?)_360(.*?)\n/', $result, $match);
      }
    }
    // var_dump($match[0]); //ini buat manggil result cuman resolusi 720

    if (count($match[0])>1) {
      echo $match[0][1]; //Low Bandwith Select
    }else{
      echo $match[0][0];
    }{{

    // var_dump(explode("\n", $result)); // Ini buat liat semua resolusi
    // echo $result[5]; // ini buat manggil result index ke 5 /hls-b/ ingest_205_720p
  }

  curl_close($ch);
  
}}}
?>
